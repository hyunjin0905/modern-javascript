<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <title>Channel messaging demo</title>
    <link rel="stylesheet" href="">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>
<h1>Channel messaging demo</h1>
<p class="output">My body</p>
<iframe src="page2.html" width='480' height='320'></iframe>
</body>
<script>
    var channel = new MessageChannel();
    var port1 = channel.port1;
    var port2 = channel.port2;

    // function queueTask(func) {
    //     port1.postMessage("queue task");
    //     port2.addEventListener("message", (e) => {
    //         console.log(e.data);
    //         func();
    //     }, { once: true });
    //     port2.start();
    // }
    //
    //
    // queueTask(() => {
    //     console.log("hello!!!!!!")
    // })

    let num = 0;
    const delayUntil = Date.now() + 3000;
    while (Date.now() < delayUntil) {
        // 586
        // queueTask(() => {
        //     console.log(num++);
        // })
    }

    // setTimeout(() => {
    //     console.log(num++);
    // }, 0)



</script>
</html>